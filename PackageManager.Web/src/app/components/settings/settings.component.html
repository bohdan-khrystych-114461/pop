<div class="container">
  <div class="header">
    <button mat-icon-button (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1>Settings - Manage Items</h1>
  </div>

  <div class="actions">
    <button mat-raised-button color="primary" (click)="showNewForm()" *ngIf="!showNewItemForm">
      <mat-icon>add</mat-icon>
      New Item
    </button>
  </div>

  <mat-card *ngIf="showNewItemForm" class="form-card">
    <mat-card-header>
      <mat-card-title>New Item</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Item Name</mat-label>
        <input matInput [(ngModel)]="newItemName" placeholder="Enter item name">
      </mat-form-field>

      <div class="image-section">
        <label class="image-label">Item Image (optional)</label>
        <p class="hint">Upload an image or paste from clipboard (Ctrl+V)</p>
        <input type="file" accept="image/*" (change)="onFileSelected($event, false)" class="file-input">

        <div *ngIf="newItemImageUrl" class="image-preview">
          <img [src]="newItemImageUrl" alt="Preview" (click)="showImage(newItemImageUrl)">
          <button mat-icon-button (click)="newItemImageUrl = ''" class="remove-image">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions>
      <button mat-raised-button color="primary" (click)="createItem()">Create</button>
      <button mat-button (click)="cancelNewItem()">Cancel</button>
    </mat-card-actions>
  </mat-card>

  <div class="loading" *ngIf="loading">
    <p>Loading items...</p>
  </div>

  <div class="items-grid" *ngIf="!loading">
    <mat-card *ngFor="let item of items" class="item-card">
      <img *ngIf="item.imageUrl" [src]="item.imageUrl" [alt]="item.name" class="item-image" (click)="showImage(item.imageUrl!)">
      <div class="item-content">
        <h3>{{ item.name }}</h3>
      </div>
      <mat-card-actions>
        <button mat-button (click)="editItem(item)">
          <mat-icon>edit</mat-icon>
          Edit
        </button>
        <button mat-button color="warn" (click)="deleteItem(item)">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </mat-card-actions>
    </mat-card>

    <div *ngIf="items.length === 0 && !showNewItemForm" class="empty-state">
      <mat-icon>inventory</mat-icon>
      <h2>No items yet</h2>
      <p>Create your first item to get started</p>
    </div>
  </div>
</div>
